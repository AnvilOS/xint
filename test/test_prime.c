
#include "test_prime.h"

#include "xint_algorithms.h"
#include "xint_io.h"

#include "test_harness.h"

TEST_GROUP(prime);

TEST(prime, simple)
{
    xint_t initial = XINT_INIT_VAL;
    xint_assign_str(initial, "123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890", 0);
    xint_t candidate = XINT_INIT_VAL;
    xint_copy(candidate, initial);

    while (1)
    {
        //int result = xint_miller_rabin(candidate, 64);
        int result = xint_is_prime(candidate);
        if (result == 1)
        {
            break;
        }
        xint_add_ulong(candidate, candidate, 1);
    }

    xint_t expected = XINT_INIT_VAL;
    xint_assign_str(expected,     "123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234569841", 0);

    ASSERT_EQ(0, xint_cmp(candidate, expected));

    END_TEST(prime);
}

int test_prime(void)
{
    CALL_TEST(prime, simple);
    
    END_TEST_GROUP(prime);
}
